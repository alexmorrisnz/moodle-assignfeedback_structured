define(["jquery","core/ajax","core/notification","core/str","core/templates","core/modal_factory"],function(a,b,c,d,e,f){function g(a,d){var f=a.getBody(),g=a.getFooter(),h=g.find('[data-action="refresh"]'),i=h.width(),j=g.find(".loading-icon");h.hide(),j.css({marginLeft:i/2+"px",marginRight:i/2+"px"}),j.show();var k=b.call([{methodname:"assignfeedback_structured_get_criteriasets",args:{contextid:d,includepublic:!1}}]);k[0].done(function(a){var b={contextId:d,criteriaSets:a.ownedSets,manage:!0};e.render("assignfeedback_structured/criteriasetsmanage",b).then(function(a,b){e.replaceNodeContents(f,a,b),j.hide(),h.show()}).fail(c.exception)}).fail(c.exception)}var h={init:function(b,h){d.get_string("criteriasetsmanage","assignfeedback_structured").then(function(d){var i={contextId:b,criteriaSets:h,manage:!0},j=a("#id_assignfeedback_structured_critsetsmanage");e.render("assignfeedback_structured/criteriasetsmanage_footer",[]).then(function(a){f.create({title:d,body:e.render("assignfeedback_structured/criteriasetsmanage",i),footer:a,large:!1},j).done(function(a){var c=a.getFooter().find('[data-action="refresh"]');c.on("click",function(){g(a,b)})})}).fail(c.exception)})}};return h});